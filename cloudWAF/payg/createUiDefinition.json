{
     "handler": "Microsoft.Compute.MultiVm",
     "version": "0.1.2-preview",
     "parameters": {
          "basics": [
          ],
          "steps": [
               {
                    "name": "infrastructureSettings",
                    "label": "Infrastructure Settings",
                    "subLabel": {
                         "preValidation": "Configure Infrastructure Settings",
                         "postValidation": "Done"
                    },
                    "bladeTitle": "Infrastructure Settings",
                    "elements": [
                         {
                              "name": "solutionDeploymentName",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Deployment Name",
                              "toolTip": "A friendly name for this deployment.",
                              "defaultValue": "F5waf",
                              "constraints": {
                                   "required": true,
                                   "regex": "^[a-z0-9A-Z]{1,10}$",
                                   "validationMessage": "Only letters and numbers are allowed, and the value must be 1-10 characters long"
                              }
                         },
                         {
                              "name": "adminUsername",
                              "type": "Microsoft.Compute.UserNameTextBox",
                              "label": "F5 WAF Username",
                              "defaultValue": "azureuser",
                              "toolTip": "Administrative username for the Azure virtual machine(s).",
                              "osPlatform": "Windows"
                         },
                         {
                              "name": "adminPassword",
                              "type": "Microsoft.Compute.CredentialsCombo",
                              "label": {
                                   "password": "F5 WAF Password",
                                   "confirmPassword": "Confirm Password"
                              },
                              "toolTip": {
                                   "password": "Administrative password for the Azure virtual machine(s)."
                              },
                              "constraints": {
                                   "required": true
                              },
                              "options": {
                                   "hideConfirmation": false
                              },
                              "osPlatform": "Windows"
                         },
                         {
                              "name": "bigIpVersion",
                              "type": "Microsoft.Common.OptionsGroup",
                              "label": "BIG-IP Version",
                              "defaultValue": "13.0.21",
                              "toolTip": "F5 BIG-IP version you want to use.",
                              "constraints": {
                                   "allowedValues": [
                                        {
                                             "label": "13.0.21",
                                             "value": "13.0.21"
                                        },
                                        {
                                             "label": "12.1.24",
                                             "value": "12.1.24"
                                        }
                                   ]
                              }
                         },
                         {
                              "name": "imageName",
                              "type": "Microsoft.Common.OptionsGroup",
                              "label": "BIG-IP Image Name",
                              "defaultValue": "Best",
                              "toolTip": "F5 SKU (IMAGE) you want to deploy. 'Best' is the only option because ASM is required.",
                              "constraints": {
                                   "allowedValues": [
                                        {
                                             "label": "Best",
                                             "value": "best"
                                        }
                                   ]
                              }
                         },
                         {
                              "name": "licensedBandwidth",
                              "type": "Microsoft.Common.DropDown",
                              "label": "Licensed Bandwidth",
                              "defaultValue": "200M",
                              "toolTip": "The amount of licensed bandwidth (Mbps) to allocate for each WAF.",
                              "constraints": {
                                   "allowedValues": [
                                        {
                                             "label": "25M",
                                             "value": "25mbps"
                                        },
                                        {
                                             "label": "200M",
                                             "value": "200mbps"
                                        },
                                        {
                                             "label": "1G",
                                             "value": "1gbps"
                                        }
                                   ]
                              }
                         },
                         {
                             "name": "storageAccount",
                              "type": "Microsoft.Storage.StorageAccountSelector",
                              "label": "Storage Account",
                              "toolTip": "Select a new or existing storage account for your WAF virtual machines. For new storage accounts, storage type will be determined by the previously selected virtual machine size. For existing storage accounts, you must ensure that the storage account is compatible with the selected virtual machine size.",
                              "defaultValue": {
                                   "name": "wafst",
                                   "type": "Premium_LRS"
                              },
                              "constraints": {
                                "allowedTypes": [
                                    "Standard_LRS",
                                    "Premium_LRS"
                                ]
                              },
                              "visible": true
                         },
                         {
                              "name": "instanceTypeStandard",
                              "type": "Microsoft.Compute.SizeSelector",
                              "label": "Virtual machine size",
                              "toolTip": "The size of virtual machine to provision for each cluster node.",
                              "recommendedSizes": [
                                   "Standard_A3"
                              ],
                              "constraints": {
                                   "allowedSizes": [
                                        "Standard_A3",
                                        "Standard_A4",
                                        "Standard_A5",
                                        "Standard_A6",
                                        "Standard_A7",
                                        "Standard_A8",
                                        "Standard_A9",
                                        "Standard_D2",
                                        "Standard_D3",
                                        "Standard_D4",
                                        "Standard_D11",
                                        "Standard_D12",
                                        "Standard_D13",
                                        "Standard_D14",
                                        "Standard_D2_v2",
                                        "Standard_D3_v2",
                                        "Standard_D4_v2",
                                        "Standard_D5_v2",
                                        "Standard_D11_v2",
                                        "Standard_D12_v2",
                                        "Standard_D13_v2",
                                        "Standard_D14_v2",
                                        "Standard_D15_v2",
                                        "Standard_F2",
                                        "Standard_F4",
                                        "Standard_F8"
                                   ]
                              },
                              "osPlatform": "Linux",
                              "imageReference": {
                                   "publisher": "f5-networks",
                                   "offer": "f5-web-application-firewall",
                                   "sku": "[concat('f5-bigip-virtual-edition-', steps('infrastructureSettings').licensedBandwidth, '-', steps('infrastructureSettings').imageName,'-hourly')]"
                              },
                              "count": "[steps('infrastructureSettings').numberOfInstances]",
                              "visible": "[equals(steps('infrastructureSettings').storageAccount.type, 'Standard_LRS')]"
                         },
                         {
                              "name": "instanceTypePremium",
                              "type": "Microsoft.Compute.SizeSelector",
                              "label": "Virtual machine size",
                              "toolTip": "The size of virtual machine to provision for each cluster node.",
                              "recommendedSizes": [
                                   "Standard_DS2",
                                   "Standard_DS2_v2"
                              ],
                              "constraints": {
                                   "allowedSizes": [
                                        "Standard_DS2",
                                        "Standard_DS3",
                                        "Standard_DS4",
                                        "Standard_DS11",
                                        "Standard_DS12",
                                        "Standard_DS13",
                                        "Standard_DS14",
                                        "Standard_DS2_v2",
                                        "Standard_DS3_v2",
                                        "Standard_DS4_v2",
                                        "Standard_DS5_v2",
                                        "Standard_DS11_v2",
                                        "Standard_DS12_v2",
                                        "Standard_DS13_v2",
                                        "Standard_DS14_v2",
                                        "Standard_DS15_v2",
                                        "Standard_F2S",
                                        "Standard_F4S",
                                        "Standard_F8S"
                                   ]
                              },
                              "osPlatform": "Linux",
                              "imageReference": {
                                   "publisher": "f5-networks",
                                   "offer": "f5-big-ip-hourly",
                                   "sku": "[concat('f5-bigip-virtual-edition-', steps('infrastructureSettings').licensedBandwidth, '-', steps('infrastructureSettings').imageName,'-hourly')]"
                              },
                              "count": "[steps('infrastructureSettings').numberOfInstances]",
                              "visible": "[equals(steps('infrastructureSettings').storageAccount.type, 'Premium_LRS')]"
                         },
                         {
                              "name": "publicIp",
                              "type": "Microsoft.Network.PublicIpAddressCombo",
                              "label": {
                                   "publicIpAddress": "Public IP address",
                                   "domainNameLabel": "Domain name label"
                              },
                              "toolTip": {
                                   "publicIpAddress": "",
                                   "domainNameLabel": ""
                              },
                              "defaultValue": {
                                   "publicIpAddressName": "waf-pip"
                              },
                              "constraints": {
                                   "required": {
                                        "domainNameLabel": true
                                   }
                              },
                              "options": {
                                   "hideNone": true,
                                   "hideDomainNameLabel": false,
                                   "hideExisting": false
                              },
                              "visible": true
                         },
                         {
                              "name": "virtualNetwork",
                              "type": "Microsoft.Network.VirtualNetworkCombo",
                              "label": {
                                   "virtualNetwork": "Virtual network",
                                   "subnets": "Subnets"
                              },
                              "toolTip": {
                                   "virtualNetwork": "Select an existing new virtual network or use the template to create a new one.",
                                   "subnets": "Select an existing subnet or use the template to create a new one."
                              },
                              "defaultValue": {
                                   "name": "waf-vnet",
                                   "addressPrefixSize": "/16"

                              },
                              "constraints": {
                                   "minAddressPrefixSize": "/22"
                              },
                              "options": {
                                   "hideExisting": false
                              },
                              "subnets": {
                                   "subnet1": {
                                        "label": "Subnet",
                                        "defaultValue": {
                                             "name": "subnet1",
                                             "addressPrefixSize": "/24"
                                        },
                                        "constraints": {
                                             "minAddressPrefixSize": "/28",
                                             "minAddressCount": 2,
                                             "requireContiguousAddresses": true
                                        }
                                   }
                              },
                              "visible": true
                         },
                         {
                              "name": "restrictedSrcAddress",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Restricted source network or address",
                              "defaultValue": "*",
                              "toolTip": "Restricts management access to a specific network or address; enter a IP address or address range in CIDR notation, or asterisk for all sources.",
                              "constraints": {
                                   "regex": "^\\*$|^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/([0-9]|[1-2][0-9]|3[0-2]))$",
                                   "required": true,
                                   "validationMessage": "Only valid CIDR addresses and the wildcard character (asterisk) are allowed."
                              }
                         },
                         {
                              "name": "ntpServer",
                              "type": "Microsoft.Common.TextBox",
                              "label": "NTP Server",
                              "defaultValue": "0.pool.ntp.org",
                              "toolTip": "If you would like to change the NTP server the BIG-IP uses replace the default ntp server with your choice.",
                              "constraints": {
                                   "regex": "^([A-z0-9]+(-[A-z0-9]+)*\\.)+[a-z]{2,}|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$",
                                   "required": true,
                                   "validationMessage": "Only valid fully-qualified domain names are allowed."
                              }
                         }
                    ]
               },
               {
                    "name": "appSettings",
                    "label": "Application Settings",
                    "subLabel": {
                         "preValidation": "Configure Application Settings",
                         "postValidation": "Done"
                    },
                    "bladeTitle": "Application Settings",
                    "elements": [
                         {
                              "name": "applicationProtocols",
                              "type": "Microsoft.Common.OptionsGroup",
                              "label": "Application Protocol(s)",
                              "defaultValue": "HTTP and HTTPS",
                              "toolTip": "The protocol(s) used to connect to your application.",
                              "constraints": {
                                   "allowedValues": [
                                        {
                                             "label": "HTTP and HTTPS",
                                             "value": "http-https"
                                        },
                                        {
                                             "label": "HTTP",
                                             "value": "http"
                                        },
                                        {
                                             "label": "HTTPS",
                                             "value": "https"
                                        },
                                        {
                                             "label": "SSL OFFLOAD",
                                             "value": "https-offload"
                                        }
                                   ]
                              }
                         },
                         {
                              "name": "applicationAddress",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Application Address",
                              "toolTip": "The public IP address or FQDN of the Application that this WAF will protect (1.2.3.4 or myapp.example.com).",
                              "constraints": {
                                   "regex": "^([A-z0-9]+(-[A-z0-9]+)*\\.)+[a-z]{2,}|[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$",
                                   "required": true,
                                   "validationMessage": "Only IP addresses and fully-qualified domain names are allowed."
                              }
                         },
                         {
                              "name": "applicationPort",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Application Port",
                              "defaultValue": "80",
                              "toolTip": "The port that your application listens on for unencrypted traffic.",
                              "constraints": {
                                   "regex": "^([0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$",
                                   "required": true,
                                   "validationMessage": "Only valid TCP port numbers are allowed."
                              },
                              "visible": "[not(equals(steps('appSettings').applicationProtocols, 'https'))]"
                         },
                         {
                              "name": "applicationSecurePort",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Application Secure Port",
                              "defaultValue": "443",
                              "toolTip": "The port that your application listens on for encrypted traffic.",
                              "constraints": {
                                   "regex": "^([0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$",
                                   "required": false,
                                   "validationMessage": "Only valid TCP port numbers are allowed."
                              },
                              "visible": "[not(equals(steps('appSettings').applicationProtocols, 'http'))]"
                         },
                         {
                              "name": "applicationType",
                              "type": "Microsoft.Common.DropDown",
                              "label": "Application Type",
                              "defaultValue": "Generic - Apache",
                              "toolTip": "Select the application type that most closely matches your application. This selection helps establish a base security policy on initial deployment, and an exact match is not required.",
                              "constraints": {
                                   "allowedValues": [
                                        {
                                             "label": "Generic - IIS",
                                             "value": "iis"
                                        },
                                        {
                                             "label": "Generic - Apache",
                                             "value": "apache"
                                        },
                                        {
                                             "label": "Generic - NGINX",
                                             "value": "nginx"
                                        },
                                        {
                                             "label": "Shop - Magento ",
                                             "value": "magento"
                                        },
                                        {
                                             "label": "Shop - WooCommerce",
                                             "value": "woo"
                                        },
                                        {
                                             "label": "Shop - BigCommerce",
                                             "value": "big"
                                        },
                                        {
                                             "label": "Shop - Volusion",
                                             "value": "volusion"
                                        },
                                        {
                                             "label": "Shop - Miva Merchant",
                                             "value": "miva"
                                        },
                                        {
                                             "label": "Shop - Shopify",
                                             "value": "shopify"
                                        },
                                        {
                                             "label": "Shop - Demandware",
                                             "value": "demandware"
                                        },
                                        {
                                             "label": "Shop - osCommerce",
                                             "value": "os"
                                        },
                                        {
                                             "label": "Shop - Generic",
                                             "value": "shop"
                                        },
                                        {
                                             "label": "CMS - WordPress",
                                             "value": "wordpress"
                                        },
                                        {
                                             "label": "CMS - Drupal",
                                             "value": "drupal"
                                        },
                                        {
                                             "label": "CMS - Joomla!",
                                             "value": "joomla"
                                        },
                                        {
                                             "label": "CMS - Blogger",
                                             "value": "blogger"
                                        },
                                        {
                                             "label": "CMS - vBulletin",
                                             "value": "vbulletin"
                                        },
                                        {
                                             "label": "CMS - ExpressionEngine",
                                             "value": "expression"
                                        },
                                        {
                                             "label": "CMS - DNN Software",
                                             "value": "dnn"
                                        },
                                        {
                                             "label": "CMS - Adobe CQ",
                                             "value": "adobecq"
                                        },
                                        {
                                             "label": "CMS - Ektron",
                                             "value": "ektron"
                                        },
                                        {
                                             "label": "CMS - Sharepoint",
                                             "value": "sharepoint"
                                        },
                                        {
                                             "label": "CMS - Generic",
                                             "value": "cms"
                                        }
                                   ]
                              }
                         },
                         {
                              "name": "blockingLevel",
                              "type": "Microsoft.Common.DropDown",
                              "label": "Security Blocking Level",
                              "defaultValue": "Medium",
                              "toolTip": "Select a security blocking level for the initial deployment. The security level sets the operating mode of the Web Application Firewall. A High security level will apply as much protection as possible for the application and will be less lenient when automatically adding exceptions. A Low security level will apply well-known protections for the application and will be most lenient when automatically adding exceptions. A Medium security level is a balanced configuration. The Off security level will configure the WAF in transparent mode. Select Custom to upload a custom security policy below to apply to this deployment.",
                              "constraints": {
                                   "required": true,
                                   "allowedValues": [
                                        {
                                             "label": "High",
                                             "value": "high"
                                        },
                                        {
                                             "label": "Medium",
                                             "value": "medium"
                                        },
                                        {
                                             "label": "Low",
                                             "value": "low"
                                        },
                                        {
                                             "label": "Off",
                                             "value": "off"
                                        },
                                        {
                                             "label": "Custom",
                                             "value": "custom"
                                        }
                                   ]
                              }
                         },
                         {
                              "name": "customPolicy",
                              "type": "Microsoft.Common.FileUpload",
                              "label": "Custom ASM Security Policy",
                              "toolTip": "A custom ASM security policy to apply to the WAF, in XML format. If specified, the policy you select here overrides the selections you made above for Application Type.",
                              "constraints": {
                                   "required": false
                              },
                              "options": {
                                   "multiple": false,
                                   "uploadMode": "url",
                                   "openMode": "text",
                                   "encoding": "UTF-8"
                              },
                              "visible": "[equals(steps('appSettings').blockingLevel, 'custom')]"
                         },
                         {
                              "name": "sslCert",
                              "type": "Microsoft.Common.FileUpload",
                              "label": "SSL Certificate Upload",
                              "toolTip": "Browse and select the SSL certificate and key (in .pfx format) corresponding to the application's public virtual server.",
                              "constraints": {
                                   "required": false,
                                   "accept": ".pfx, .p12"
                              },
                              "options": {
                                   "multiple": false,
                                   "uploadMode": "url",
                                   "openMode": "text",
                                   "encoding": "UTF-8"
                              },
                              "visible": "[not(equals(steps('appSettings').applicationProtocols, 'http'))]"
                         },
                         {
                              "name": "sslPswd",
                              "type": "Microsoft.Common.PasswordBox",
                              "label": {
                                   "password": "Certificate Passphrase",
                                   "confirmPassword": "Confirm Passphrase"
                              },
                              "toolTip": "Enter the passphrase for the specified .pfx file.",
                              "constraints": {
                                   "required": false
                              },
                              "options": {
                                   "hideConfirmation": true
                              },
                              "visible": "[not(equals(steps('appSettings').applicationProtocols, 'http'))]"
                         },
                         {
                              "name": "applicationPlatform",
                              "type": "Microsoft.Common.OptionsGroup",
                              "label": "Application Platform",
                              "defaultValue": "IaaS",
                              "toolTip": "The platform on which you have deployed your application. Select IaaS if your application is deployed on an Azure Virtual Machine. Select PaaS if your application is deployed on an Azure Application Service or Application Service Environment.",
                              "constraints": {
                                   "allowedValues": [
                                        {
                                             "label": "IaaS",
                                             "value": "iaas"
                                        },
                                        {
                                             "label": "PaaS",
                                             "value": "paas"
                                        }
                                   ]
                              }
                         },
                         {
                              "name": "applicationServiceFqdn",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Application Service FQDN",
                              "toolTip": "The public FQDN of your application, if deploying an Azure App Service (optional).",
                              "constraints": {
                                   "regex": "^([A-z0-9]+(-[A-z0-9]+)*\\.)+[a-z]{2,}$",
                                   "required": false,
                                   "validationMessage": "Only fully-qualified domain names are allowed."
                              },
                              "visible": "[equals(steps('appSettings').applicationPlatform, 'paas')]"
                         }
                    ]
               },
               {
                    "name": "autoscaleSettings",
                    "label": "Autoscale Settings",
                    "subLabel": {
                         "preValidation": "Configure Autoscale Settings",
                         "postValidation": "Done"
                    },
                    "bladeTitle": "Autoscale Settings",
                    "elements": [
                        {
                            "name": "vmScaleSetMinCount",
                             "type": "Microsoft.Common.DropDown",
                             "label": "VM Scale Set Minimum Count",
                             "defaultValue": "2",
                             "toolTip": "The minimum (and default) number of BIG-IP VEs that will be deployed into the VM Scale Set.",
                             "constraints": {
                                  "allowedValues": [
                                       {
                                            "label": "1",
                                            "value": "1"
                                       },
                                       {
                                            "label": "2",
                                            "value": "2"
                                       },
                                       {
                                            "label": "3",
                                            "value": "3"
                                       },
                                       {
                                            "label": "4",
                                            "value": "4"
                                       },
                                       {
                                            "label": "5",
                                            "value": "5"
                                       },
                                       {
                                            "label": "6",
                                            "value": "6"
                                       }
                                  ]
                             }
                        },
                        {
                            "name": "vmScaleSetMaxCount",
                             "type": "Microsoft.Common.DropDown",
                             "label": "VM Scale Set Maximum Count",
                             "defaultValue": "4",
                             "toolTip": "The maximum number of BIG-IP VEs that can be deployed into the VM Scale Set.",
                             "constraints": {
                                  "allowedValues": [
                                      {
                                           "label": "2",
                                           "value": "2"
                                      },
                                      {
                                           "label": "3",
                                           "value": "3"
                                      },
                                      {
                                           "label": "4",
                                           "value": "4"
                                      },
                                      {
                                           "label": "5",
                                           "value": "5"
                                      },
                                      {
                                           "label": "6",
                                           "value": "6"
                                      },
                                      {
                                           "label": "7",
                                           "value": "7"
                                      },
                                      {
                                           "label": "8",
                                           "value": "8"
                                      }
                                  ]
                             }
                        },
                        {
                            "name": "scaleOutThroughput",
                             "type": "Microsoft.Common.DropDown",
                             "label": "VM Scale Set Scale Out Throughput",
                             "defaultValue": "90",
                             "toolTip": "The percentage of 'Network Out' throughput that triggers a Scale Out event.  This is factored as a percentage of the F5 PAYG image bandwidth (Mbps) size you choose.",
                             "constraints": {
                                  "allowedValues": [
                                      {
                                           "label": "50",
                                           "value": "50"
                                      },
                                      {
                                           "label": "55",
                                           "value": "55"
                                      },
                                      {
                                           "label": "60",
                                           "value": "60"
                                      },
                                      {
                                           "label": "65",
                                           "value": "65"
                                      },
                                      {
                                           "label": "70",
                                           "value": "70"
                                      },
                                      {
                                           "label": "75",
                                           "value": "75"
                                      },
                                      {
                                           "label": "80",
                                           "value": "80"
                                      },
                                      {
                                           "label": "85",
                                           "value": "85"
                                      },
                                      {
                                           "label": "90",
                                           "value": "90"
                                      },
                                      {
                                           "label": "95",
                                           "value": "95"
                                      }
                                  ]
                             }
                        },
                        {
                            "name": "scaleInThroughput",
                             "type": "Microsoft.Common.DropDown",
                             "label": "VM Scale Set Scale In Throughput",
                             "defaultValue": "10",
                             "toolTip": "The percentage of 'Network Out' throughput that triggers a Scale In event.  This is factored as a percentage of the F5 PAYG image bandwidth (Mbps) size you choose.",
                             "constraints": {
                                  "allowedValues": [
                                      {
                                           "label": "5",
                                           "value": "5"
                                      },
                                      {
                                           "label": "10",
                                           "value": "10"
                                      },
                                      {
                                           "label": "15",
                                           "value": "15"
                                      },
                                      {
                                           "label": "20",
                                           "value": "20"
                                      },
                                      {
                                           "label": "25",
                                           "value": "25"
                                      },
                                      {
                                           "label": "30",
                                           "value": "30"
                                      },
                                      {
                                           "label": "35",
                                           "value": "35"
                                      },
                                      {
                                           "label": "40",
                                           "value": "40"
                                      },
                                      {
                                           "label": "45",
                                           "value": "45"
                                      }
                                  ]
                             }
                        },
                        {
                            "name": "scaleTimeWindow",
                             "type": "Microsoft.Common.DropDown",
                             "label": "VM Scale Set Scale Time Window",
                             "defaultValue": "10",
                             "toolTip": "The time window required to trigger a scale event (in and out). This is used to determine the amount of time needed for a threshold to be breached, as well as to prevent excessive scaling events (flapping).",
                             "constraints": {
                                  "allowedValues": [
                                      {
                                           "label": "5",
                                           "value": "5"
                                      },
                                      {
                                           "label": "10",
                                           "value": "10"
                                      },
                                      {
                                           "label": "15",
                                           "value": "15"
                                      },
                                      {
                                           "label": "30",
                                           "value": "30"
                                      }
                                  ]
                             }
                        },
                        {
                              "name": "tenantId",
                              "type": "Microsoft.Common.TextBox",
                              "label": "Tenant ID",
                              "toolTip": "Your Azure service principal application tenant ID.",
                              "constraints": {
                                   "required": true,
                                   "validationMessage": "Please provide a valid tenant ID for your service prinicipal application."
                              },
                              "visible": "[equals(steps('appSettings').applicationPlatform, 'paas')]"
                         },
                         {
                               "name": "clientId",
                               "type": "Microsoft.Common.TextBox",
                               "label": "Client ID",
                               "toolTip": "Your Azure service principal application client ID.",
                               "constraints": {
                                    "required": true,
                                    "validationMessage": "Please provide a valid client ID for your service prinicipal application."
                               },
                               "visible": "[equals(steps('appSettings').applicationPlatform, 'paas')]"
                          },
                          {
                                "name": "servicePrincipalSecret",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Secret",
                                "toolTip": "Your Azure service principal application secret.",
                                "constraints": {
                                     "required": true,
                                     "validationMessage": "Please provide a valid secret key for your service prinicipal application."
                                },
                                "visible": "[equals(steps('appSettings').applicationPlatform, 'paas')]"
                           }
                    ]
               }
          ],
          "outputs": {
               "location": "[location()]",
               "solutionDeploymentName": "[steps('infrastructureSettings').solutionDeploymentName]",
               "adminUsername": "[steps('infrastructureSettings').adminUsername]",
               "adminPassword": "[steps('infrastructureSettings').adminPassword.password]",
               "licensedBandwidth": "[steps('infrastructureSettings').licensedBandwidth]",
               "instanceType": "[coalesce(steps('infrastructureSettings').instanceTypeStandard, steps('infrastructureSettings').instanceTypePremium)]",
               "imageName": "[steps('infrastructureSettings').imageName]",
               "bigIpVersion": "[steps('infrastructureSettings').bigIpVersion]",
               "storageAccountNewOrExisting": "[steps('infrastructureSettings').storageAccount.newOrExisting]",
               "storageAccountExistingRGName": "[steps('infrastructureSettings').storageAccount.resourceGroup]",
               "storageAccountName": "[steps('infrastructureSettings').storageAccount.name]",
               "storageAccountType": "[steps('infrastructureSettings').storageAccount.type]",
               "publicIpNewOrExisting": "[steps('infrastructureSettings').publicIp.newOrExistingOrNone]",
               "publicIpExistingRGName": "[steps('infrastructureSettings').publicIp.resourceGroup]",
               "publicIpName": "[steps('infrastructureSettings').publicIp.name]",
               "dnsLabel": "[steps('infrastructureSettings').publicIp.domainNameLabel]",
               "vnetNewOrExisting": "[steps('infrastructureSettings').virtualNetwork.newOrExisting]",
               "vnetName": "[steps('infrastructureSettings').virtualNetwork.name]",
               "vnetExistingRGName": "[steps('infrastructureSettings').virtualNetwork.resourceGroup]",
               "vnetAddressPrefix": "[steps('infrastructureSettings').virtualNetwork.addressPrefix]",
               "subnetName": "[steps('infrastructureSettings').virtualNetwork.subnets.subnet1.name]",
               "subnetAddressPrefix": "[steps('infrastructureSettings').virtualNetwork.subnets.subnet1.addressPrefix]",
               "privateIpAddressRangeStart": "[steps('infrastructureSettings').virtualNetwork.subnets.subnet1.startAddress]",
               "restrictedSrcAddress": "[steps('infrastructureSettings').restrictedSrcAddress]",
               "ntpServer": "[steps('infrastructureSettings').ntpServer]",
               "applicationProtocols": "[steps('appSettings').applicationProtocols]",
               "applicationAddress": "[steps('appSettings').applicationAddress]",
               "applicationPort": "[steps('appSettings').applicationPort]",
               "applicationSecurePort": "[steps('appSettings').applicationSecurePort]",
               "applicationType": "[steps('appSettings').applicationType]",
               "applicationServiceFqdn": "[steps('appSettings').applicationServiceFqdn]",
               "blockingLevel": "[steps('appSettings').blockingLevel]",
               "customPolicy": "[steps('appSettings').customPolicy]",
               "sslCert": "[steps('appSettings').sslCert]",
               "sslPswd": "[steps('appSettings').sslPswd]",
               "vmScaleSetMinCount": "[int(steps('autoscaleSettings').vmScaleSetMinCount)]",
               "vmScaleSetMaxCount": "[int(steps('autoscaleSettings').vmScaleSetMaxCount)]",
               "scaleOutThroughput": "[int(steps('autoscaleSettings').scaleOutThroughput)]",
               "scaleInThroughput": "[int(steps('autoscaleSettings').scaleInThroughput)]",
               "scaleTimeWindow": "[int(steps('autoscaleSettings').scaleTimeWindow)]",
               "tenantId": "[steps('autoscaleSettings').tenantId]",
               "clientId": "[steps('autoscaleSettings').clientId]",
               "servicePrincipalSecret": "[steps('autoscaleSettings').servicePrincipalSecret]"
          }
     }
}
